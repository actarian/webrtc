{"version":3,"sources":["src/js/main.js","../../src/js/webrtc/signaling.service.js","../../src/js/webrtc/user-media.service.js","../../src/js/webrtc/webrtc-client.service.js","../../src/js/webrtc/websocket.service.js","../../src/js/app.component.js","../../src/js/environment.served.js","../../src/js/utils/utils.js","../../src/js/environment.js","../../src/js/environment.static.js","../../src/js/flag/flag.pipe.js","../../src/js/webrtc/webrtc-stream.component.js","../../src/js/app.module.js","../../src/js/main.js"],"names":["g","f","exports","module","require","define","amd","globalThis","self","rxcomp","rxjs","operators","this","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","Constructor","protoProps","staticProps","prototype","_defineProperty","obj","value","_inheritsLoose","subClass","superClass","create","constructor","_setPrototypeOf","o","p","setPrototypeOf","__proto__","SignalingService","in","message","in$","next","out","out$","send","sendBack","assign","clientId","remoteId","broadcast","ReplaySubject","UserMediaService","getUserMedia","Promise","resolve","reject","navigator","mediaDevices","audio","video","width","min","ideal","max","height","then","stream","catch","error","console","log","OFFER_OPTIONS","offerToReceiveAudio","offerToReceiveVideo","WebRTCClient","uid","_this","BehaviorSubject","getUniqueUserId","MediaStream","onIceCandidate","bind","onIceConnectionStateChange","onIceGatheringStateChange","onSignalingStateChange","onNegotiationceNeeded","onTrack","connection","RTCPeerConnection","getTracks","forEach","track","addTrack","addEventListener","pipe","filter","event","subscribe","type","onMessageCandidate","onMessageAnswer","_proto","dispose","remote$","removeEventListener","close","candidate","iceConnectionState","iceGatheringState","signalingState","_this2","createOffer","offer","setLocalDescription","_","description","localDescription","x","onCreateOfferReject","remote","streams","sendOffer","_this3","addIceCandidate","onAddIceCandidateReject","onMessageOffer","_this4","RTCSessionDescription","setRemoteDescription","createAnswer","answer","onCreateAnswerReject","all","call","Math","floor","random","Date","now","toString","WebRTCClientService","addPeer","peerId","peers","peers$","getValue","slice","reduce","c","client","push","switchRemotes","addPeers","peerIds","removePeer","index","splice","remotes","map","remotes$","combineLatest","of","switchAll","WebSocketService","connect","onMessageCallback","onOpen","onClose","onMessage","host","location","origin","replace","socket","WebSocket","disconnect","message$","JSON","parse","data","response","backMessage","timeStamp","stringify","sendAll","AppComponent","_Component","apply","arguments","onInit","getContext","node","classList","remove","local","tap","onSocketConnected","onJoined","onPeers","onPeerJoined","onPeerLeaved","onOffer","takeUntil","unsubscribe$","pushChanges","onJoin","info","firstName","lastName","remotePeers","indexOf","onCall","get","Component","meta","selector","Utils","merge","source","keys","Array","isArray","NODE","BASE_HREF","URLSearchParams","window","search","document","querySelector","getAttribute","HEROKU","STATIC","port","DEVELOPMENT","split","ENV","PRODUCTION","Environment","options","url","language","market","getAbsoluteUrl","path","params","getPath","isLocal","href","set","githubDocs","defaultAppOptions","channelName","flags","production","useProxy","useToken","selfService","guidedTourRequest","editor","ar","menu","attendee","streamer","viewer","smartDevice","maxQuality","heroku","environmentOptions","logo","background","image","colors","menuBackground","menuForeground","menuOverBackground","menuOverForeground","menuBackBackground","menuBackForeground","menuBackOverBackground","menuBackOverForeground","assets","worker","languages","defaultLanguage","fontFamily","disabledViewTypes","disabledViewItemTypes","renderOrder","panorama","model","plane","tile","banner","nav","panel","debug","pointer","environment","bhere","FlagPipe","_Pipe","transform","Pipe","name","WebRTCStreamComponent","onChanges","srcObject","inputs","template","AppModule","_Module","Module","imports","CoreModule","declarations","bootstrap","Browser"],"mappings":"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","file":"docs\\js\\main.min.js","sourcesContent":[null,"import { ReplaySubject } from 'rxjs';\r\n\r\nexport class SignalingService {\r\n\r\n\tstatic in$ = new ReplaySubject(1);\r\n\tstatic in(message) {\r\n\t\tSignalingService.in$.next(message);\r\n\t}\r\n\r\n\tstatic out$ = new ReplaySubject(1);\r\n\tstatic out(message) {\r\n\t\tSignalingService.out$.next(message);\r\n\t}\r\n\tstatic send(message) {\r\n\t\tSignalingService.out$.next(message);\r\n\t}\r\n\tstatic sendBack(message) {\r\n\t\tmessage = Object.assign({}, message, { clientId: message.remoteId, remoteId: message.clientId });\r\n\t\tSignalingService.out$.next(message);\r\n\t}\r\n\tstatic broadcast(message) {\r\n\t\tmessage.broadcast = true;\r\n\t\tSignalingService.out$.next(message);\r\n\t}\r\n\r\n}\r\n","\r\nexport class UserMediaService {\r\n\r\n\tstatic stream = null;\r\n\r\n\tstatic getUserMedia() {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tconst options = {\r\n\t\t\t\taudio: true,\r\n\t\t\t\tvideo: {\r\n\t\t\t\t\twidth: { min: 320, ideal: 640, max: 640 },\r\n\t\t\t\t\theight: { min: 240, ideal: 480, max: 480 }\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tnavigator.mediaDevices.getUserMedia(options).then((stream) => {\r\n\t\t\t\t// console.log('UserMediaService.getUserMedia', stream);\r\n\t\t\t\tUserMediaService.stream = stream;\r\n\t\t\t\t/*/\r\n\t\t\t\tconst audioTracks = stream.getAudioTracks();\r\n\t\t\t\tif (audioTracks.length > 0) {\r\n\t\t\t\t\tconsole.log('UserMediaService.audioTracks', audioTracks[0].label);\r\n\t\t\t\t}\r\n\t\t\t\tconst videoTracks = stream.getVideoTracks();\r\n\t\t\t\tif (videoTracks.length > 0) {\r\n\t\t\t\t\tconsole.log('UserMediaService.videoTracks', videoTracks[0].label);\r\n\t\t\t\t}\r\n\t\t\t\t/*/\r\n\t\t\t\tresolve(stream);\r\n\r\n\t\t\t}).catch(error => {\r\n\t\t\t\tconsole.log('UserMediaService.getUserMedia.error', error);\r\n\t\t\t\treject(error);\r\n\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n}\r\n","import { BehaviorSubject, combineLatest, of, ReplaySubject } from \"rxjs\";\r\nimport { filter, switchAll } from \"rxjs/operators\";\r\nimport { SignalingService } from \"./signaling.service\";\r\n\r\nconst SERVERS = null;\r\n\r\nconst OFFER_OPTIONS = {\r\n\tofferToReceiveAudio: true,\r\n\tofferToReceiveVideo: true\r\n};\r\n\r\nconst state = {\r\n\tlocal: null,\r\n};\r\n\r\nexport class WebRTCClient {\r\n\r\n\tremote$ = new BehaviorSubject(null);\r\n\r\n\tconstructor(stream, uid = null, remoteId = null) {\r\n\t\tthis.uid = uid || WebRTCClient.getUniqueUserId();\r\n\t\tthis.remoteId = remoteId;\r\n\t\tthis.stream = stream || new MediaStream();\r\n\t\tthis.onIceCandidate = this.onIceCandidate.bind(this);\r\n\t\tthis.onIceConnectionStateChange = this.onIceConnectionStateChange.bind(this);\r\n\t\tthis.onIceGatheringStateChange = this.onIceGatheringStateChange.bind(this);\r\n\t\tthis.onSignalingStateChange = this.onSignalingStateChange.bind(this);\r\n\t\tthis.onNegotiationceNeeded = this.onNegotiationceNeeded.bind(this);\r\n\t\tthis.onTrack = this.onTrack.bind(this);\r\n\t\t// Create an RTCPeerConnection via the polyfill.\r\n\t\tconst connection = this.connection = new RTCPeerConnection(SERVERS);\r\n\t\tif (stream) {\r\n\t\t\tstream.getTracks().forEach(track => connection.addTrack(track, stream));\r\n\t\t}\r\n\t\tconnection.addEventListener('icecandidate', this.onIceCandidate);\r\n\t\tconnection.addEventListener('iceconnectionstatechange', this.onIceConnectionStateChange);\r\n\t\tconnection.addEventListener('icegatheringstatechange', this.onIceGatheringStateChange);\r\n\t\tconnection.addEventListener('signalingstatechange', this.onSignalingStateChange);\r\n\t\tconnection.addEventListener('negotiationneeded', this.onNegotiationceNeeded);\r\n\t\tconnection.addEventListener('track', this.onTrack);\r\n\t\tSignalingService.in$.pipe(\r\n\t\t\t// tap(event => console.log(event)),\r\n\t\t\tfilter(event => event.uid !== this.uid),\r\n\t\t).subscribe(message => {\r\n\t\t\t// console.log('WebRTCClient.message', message);\r\n\t\t\tswitch (message.type) {\r\n\t\t\t\tcase 'candidate':\r\n\t\t\t\t\tthis.onMessageCandidate(message);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t/*\r\n\t\t\tcase 'offer':\r\n\t\t\t\tthis.onMessageOffer(message);\r\n\t\t\t\tbreak;\r\n\t\t\t\t*/\r\n\t\t\t\tcase 'answer':\r\n\t\t\t\t\tthis.onMessageAnswer(message);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\t\t// this.sendOffer();\r\n\t}\r\n\r\n\tdispose() {\r\n\t\tthis.remote$.next(null);\r\n\r\n\t\tconst connection = this.connection;\r\n\t\tconnection.removeEventListener('icecandidate', this.onIceCandidate);\r\n\t\tconnection.removeEventListener('iceconnectionstatechange', this.onIceConnectionStateChange);\r\n\t\tconnection.removeEventListener('icegatheringstatechange', this.onIceGatheringStateChange);\r\n\t\tconnection.removeEventListener('signalingstatechange', this.onSignalingStateChange);\r\n\t\tconnection.removeEventListener('negotiationneeded', this.onNegotiationceNeeded);\r\n\t\tconnection.removeEventListener('track', this.onTrack);\r\n\t\t/*\r\n\t\tconnection.getTracks().forEach(track => {\r\n\t\t\ttrack.stop();\r\n\t\t});\r\n\t\t*/\r\n\r\n\t\t/*\r\n\t\tconnection.getTransceivers().forEach(transceiver => {\r\n\t\t\ttransceiver.stop();\r\n\t\t});\r\n\t\t*/\r\n\r\n\t\t/*\r\n\t\tif (localVideo.srcObject) {\r\n\t\t\tlocalVideo.pause();\r\n\t\t\tlocalVideo.srcObject.getTracks().forEach(track => {\r\n\t\t\t\ttrack.stop();\r\n\t\t\t});\r\n\t\t}\r\n\t\t*/\r\n\r\n\t\t// Close the peer connection\r\n\r\n\t\tconnection.close();\r\n\t\tthis.connection = null;\r\n\t\t// webcamStream = null;\r\n\t}\r\n\r\n\tonIceCandidate(event) {\r\n\t\t// console.log('WebRTCClient.onIceCandidate', event);\r\n\t\tconst candidate = event.candidate;\r\n\t\tif (candidate) {\r\n\t\t\tSignalingService.send({ type: 'candidate', candidate, uid: this.uid, remoteId: this.remoteId });\r\n\t\t}\r\n\t}\r\n\r\n\tonIceConnectionStateChange(event) {\r\n\t\t// console.log('WebRTCClient.onIceConnectionStateChange', event);\r\n\t\tswitch (this.iceConnectionState) {\r\n\t\t\tcase 'closed':\r\n\t\t\tcase 'failed':\r\n\t\t\tcase 'disconnected':\r\n\t\t\t\tthis.dispose();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tonIceGatheringStateChange(event) {\r\n\t\tconsole.log('WebRTCClient.onIceGatheringStateChange', this.connection.iceGatheringState);\r\n\t}\r\n\r\n\tonSignalingStateChange(event) {\r\n\t\t// console.log('WebRTCClient.onSignalingStateChange', this.connection.signalingState);\r\n\t\tswitch (this.connection.signalingState) {\r\n\t\t\tcase 'closed':\r\n\t\t\t\tthis.dispose();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tonNegotiationceNeeded(event) {\r\n\t\t// console.log('WebRTCClient.onNegotiationceNeeded', event);\r\n\t\tthis.connection.createOffer(OFFER_OPTIONS).then((offer) => {\r\n\t\t\t/*\r\n\t\t\tif (this.connection.signalingState != 'stable') {\r\n\t\t\t\tconsole.log('WebRTCClient.onNegotiationceNeeded', 'The connection isn\\'t stable yet; postponing...');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t*/\r\n\t\t\tthis.connection.setLocalDescription(offer).then(_ => {\r\n\t\t\t\tSignalingService.send({ type: 'offer', description: this.connection.localDescription, uid: this.uid, remoteId: this.remoteId });\r\n\t\t\t});\r\n\t\t}, (x) => this.onCreateOfferReject(x));\r\n\t}\r\n\r\n\tonTrack(event) {\r\n\t\tconst remote = event.streams[0];\r\n\t\tconsole.log('WebRTCClient.onTrack', remote);\r\n\t\tthis.remote$.next(remote);\r\n\t}\r\n\r\n\tsendOffer() {\r\n\t\tthis.connection.createOffer(OFFER_OPTIONS).then((offer) => {\r\n\t\t\tthis.connection.setLocalDescription(offer).then(_ => {\r\n\t\t\t\tSignalingService.send({ type: 'offer', description: this.connection.localDescription, uid: this.uid, remoteId: this.remoteId });\r\n\t\t\t});\r\n\t\t}, (x) => this.onCreateOfferReject(x));\r\n\t}\r\n\r\n\tonMessageCandidate(message) {\r\n\t\tif (message.uid !== this.remoteId) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// console.log('WebRTCClient.onMessageCandidate', 'uid', message.uid);\r\n\t\tthis.connection.addIceCandidate(message.candidate).then(() => {\r\n\t\t\t// console.log('WebRTCService.onAddIceCandidateResolve', message.candidate.candidate);\r\n\t\t}, this.onAddIceCandidateReject);\r\n\t}\r\n\r\n\tonMessageOffer(message) {\r\n\t\tif (message.uid !== this.remoteId) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// console.log('WebRTCClient.onMessageOffer', 'uid', message.uid);\r\n\t\tconst description = new RTCSessionDescription(message.description);\r\n\t\tconst onAnswer = () => {\r\n\t\t\tthis.connection.createAnswer().then((answer) => {\r\n\t\t\t\tthis.connection.setLocalDescription(answer).then(_ => {\r\n\t\t\t\t\tSignalingService.send({ type: 'answer', description: this.connection.localDescription, uid: this.uid, remoteId: this.remoteId });\r\n\t\t\t\t});\r\n\t\t\t}, (x) => this.onCreateAnswerReject(x));\r\n\t\t}\r\n\t\tif (this.connection.signalingState != 'stable') {\r\n\t\t\tPromise.all([\r\n\t\t\t\tthis.connection.setLocalDescription({ type: \"rollback\" }),\r\n\t\t\t\tthis.connection.setRemoteDescription(description).catch(error => {\r\n\t\t\t\t\tconsole.log('WebRTCClient.onMessageOffer.setRemoteDescription.error', error);\r\n\t\t\t\t}),\r\n\t\t\t]);\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t\tthis.connection.setRemoteDescription(description).then(_ => {\r\n\t\t\t\tonAnswer();\r\n\t\t\t}).catch(error => {\r\n\t\t\t\tconsole.log('WebRTCClient.onMessageOffer.setRemoteDescription.error', error);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tonMessageAnswer(message) {\r\n\t\tif (message.uid !== this.remoteId) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// console.log('WebRTCClient.onMessageAnswer', 'uid', message.uid);\r\n\t\t// Since the 'remote' side has no media stream we need\r\n\t\t// to pass in the right constraints in order for it to\r\n\t\t// accept the incoming offer of audio and video.\r\n\t\tthis.connection.setRemoteDescription(new RTCSessionDescription(message.description)).catch(error => {\r\n\t\t\tconsole.log('WebRTCClient.onMessageAnswer.setRemoteDescription.error', error);\r\n\t\t});\r\n\t}\r\n\r\n\tonAddIceCandidateReject(error) {\r\n\t\tconsole.log('WebRTCClient.onAddIceCandidateReject.error', error);\r\n\t}\r\n\r\n\tonCreateOfferReject(error) {\r\n\t\tconsole.log('WebRTCClient.onCreateOfferReject.error', error);\r\n\t}\r\n\r\n\tonCreateAnswerReject(error) {\r\n\t\tconsole.log('WebRTCClient.onCreateAnswerReject.error', error);\r\n\t}\r\n\r\n\tstatic call(stream, uid = null, remoteId = null) {\r\n\t\t// console.log('WebRTCClient.call', remoteId);\r\n\t\tconst client = new WebRTCClient(stream, uid, remoteId);\r\n\t\treturn client;\r\n\t}\r\n\r\n\tstatic answer(stream, uid = null, remoteId = null) {\r\n\t\t// console.log('WebRTCClient.answer', remoteId);\r\n\t\tconst client = new WebRTCClient(stream, uid, remoteId);\r\n\t\treturn client;\r\n\t}\r\n\r\n\tstatic getUniqueUserId() {\r\n\t\t// max safe integer 9007199254740991 length 16\r\n\t\t// max allowed integer 4294967296 2^32\r\n\t\tconst m = 9007199254740991;\r\n\t\tconst mult = 10000000000000;\r\n\t\tconst a = (1 + Math.floor(Math.random() * 8)) * 100;\r\n\t\tconst b = (1 + Math.floor(Math.random() * 8)) * 10;\r\n\t\tconst c = (1 + Math.floor(Math.random() * 8)) * 1;\r\n\t\tconst combo = (a + b + c);\r\n\t\tconst date = Date.now();\r\n\t\tconst uid = combo * mult + date;\r\n\t\t// console.log(combo);\r\n\t\t// console.log(date);\r\n\t\t// console.log(m);\r\n\t\t// console.log('AgoraService.getUniqueUserId', uid);\r\n\t\treturn uid.toString();\r\n\t\t// return Math.floor(Math.random() * 100000) + '-' + new Date().getTime();\r\n\t}\r\n}\r\n\r\nexport class WebRTCClientService {\r\n\r\n\tstatic remotes$ = new ReplaySubject().pipe(\r\n\t\tswitchAll(),\r\n\t);\r\n\tstatic peers$ = new BehaviorSubject([]);\r\n\r\n\tstatic addPeer(stream, uid, peerId) {\r\n\t\tconst peers = this.peers$.getValue().slice();\r\n\t\tconst index = peers.reduce((p, c, i) => {\r\n\t\t\treturn c.remoteId === peerId ? i : p;\r\n\t\t}, -1);\r\n\t\tif (index !== -1) {\r\n\t\t\treturn null;\r\n\t\t} else {\r\n\t\t\tconst client = new WebRTCClient(stream, uid, peerId);\r\n\t\t\tpeers.push(client);\r\n\t\t\tthis.peers$.next(peers);\r\n\t\t\tthis.switchRemotes();\r\n\t\t\treturn client;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic addPeers(stream, uid, peerIds) {\r\n\t\tconst peers = this.peers$.getValue().slice();\r\n\t\tpeerIds.forEach(peerId => {\r\n\t\t\tconst client = new WebRTCClient(stream, uid, peerId);\r\n\t\t\tpeers.push(client);\r\n\t\t})\r\n\t\tthis.peers$.next(peers);\r\n\t\tthis.switchRemotes();\r\n\t}\r\n\r\n\tstatic removePeer(peerId) {\r\n\t\tconst peers = this.peers$.getValue().slice();\r\n\t\tconst index = peers.reduce((p, c, i) => {\r\n\t\t\treturn c.remoteId === peerId ? i : p;\r\n\t\t}, -1);\r\n\t\tif (index !== -1) {\r\n\t\t\tconst client = peers[index];\r\n\t\t\tclient.dispose();\r\n\t\t\tpeers.splice(index, 1);\r\n\t\t\tthis.peers$.next(peers);\r\n\t\t\tthis.switchRemotes();\r\n\t\t}\r\n\t}\r\n\r\n\tstatic switchRemotes() {\r\n\t\tconst peers = this.peers$.getValue().slice();\r\n\t\tconst remotes = peers.map(client => client.remote$);\r\n\t\tconst remotes$ = remotes.length ? combineLatest(remotes) : of([]);\r\n\t\tWebRTCClientService.remotes$.next(remotes$);\r\n\t}\r\n\r\n}\r\n","import { ReplaySubject } from \"rxjs\";\r\n\r\nexport class WebSocketService {\r\n\r\n\tstatic message$ = new ReplaySubject(1);\r\n\r\n\tstatic connect(uid = null, onMessageCallback = null) {\r\n\t\tuid = uid || this.getUniqueUserId();\r\n\t\tthis.uid = uid;\r\n\t\tthis.onMessageCallback = onMessageCallback;\r\n\t\tthis.onOpen = this.onOpen.bind(this);\r\n\t\tthis.onClose = this.onClose.bind(this);\r\n\t\tthis.onMessage = this.onMessage.bind(this);\r\n\t\tconst host = location.origin.replace(/^https/, 'wss').replace(/^http/, 'ws');\r\n\t\tconst socket = this.socket = new WebSocket(host);\r\n\t\tsocket.addEventListener('open', this.onOpen);\r\n\t\tsocket.addEventListener('close', this.onClose);\r\n\t\tsocket.addEventListener('message', this.onMessage);\r\n\t}\r\n\r\n\tstatic disconnect() {\r\n\t\tconst socket = this.socket;\r\n\t\tif (socket) {\r\n\t\t\tsocket.close();\r\n\t\t\tthis.socket = null;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic onOpen(event) {\r\n\t\t// console.log('WebSocketService.onOpen');\r\n\t\tconst message = { type: 'socketConnected' };\r\n\t\tthis.message$.next(message);\r\n\t\tif (typeof this.onMessageCallback === 'function') {\r\n\t\t\tthis.onMessageCallback(message);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic onClose(event) {\r\n\t\t// console.log('WebSocketService.onClose');const message = { type: 'socketConnected' };\r\n\t\tconst message = { type: 'socketDisconnected' };\r\n\t\tthis.message$.next(message);\r\n\t\tif (typeof this.onMessageCallback === 'function') {\r\n\t\t\tthis.onMessageCallback(message);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic onMessage(event) {\r\n\t\tconst message = JSON.parse(event.data);\r\n\t\t// console.log('WebSocketService.onMessage', message);\r\n\t\tif (message.remoteId) {\r\n\t\t\tmessage.sendBack = (response = {}) => {\r\n\t\t\t\tconst backMessage = Object.assign({}, message, response, { uid: message.remoteId, remoteId: message.uid });\r\n\t\t\t\tWebSocketService.send(backMessage);\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (typeof this.onMessageCallback === 'function') {\r\n\t\t\tthis.onMessageCallback(message);\r\n\t\t}\r\n\t\tthis.message$.next(message);\r\n\t}\r\n\r\n\tstatic send(message = {}, broadcast) {\r\n\t\tconst socket = WebSocketService.socket;\r\n\t\tmessage.uid = this.uid;\r\n\t\tmessage.timeStamp = Date.now();\r\n\t\tif (broadcast) {\r\n\t\t\tmessage.broadcast = true;\r\n\t\t}\r\n\t\t// console.log('WebSocketService.send', message);\r\n\t\tsocket.send(JSON.stringify(message));\r\n\t}\r\n\r\n\tstatic sendAll(message = {}) {\r\n\t\tWebSocketService.send(message, true);\r\n\t}\r\n\r\n\tstatic getUniqueUserId() {\r\n\t\t// max safe integer 9007199254740991 length 16\r\n\t\t// max allowed integer 4294967296 2^32\r\n\t\tconst m = 9007199254740991;\r\n\t\tconst mult = 10000000000000;\r\n\t\tconst a = (1 + Math.floor(Math.random() * 8)) * 100;\r\n\t\tconst b = (1 + Math.floor(Math.random() * 8)) * 10;\r\n\t\tconst c = (1 + Math.floor(Math.random() * 8)) * 1;\r\n\t\tconst combo = (a + b + c);\r\n\t\tconst date = Date.now();\r\n\t\tconst uid = combo * mult + date;\r\n\t\t// console.log(combo);\r\n\t\t// console.log(date);\r\n\t\t// console.log(m);\r\n\t\t// console.log('AgoraService.getUniqueUserId', uid);\r\n\t\treturn uid.toString();\r\n\t}\r\n\r\n}\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { filter, takeUntil, tap } from 'rxjs/operators';\r\nimport { SignalingService } from './webrtc/signaling.service';\r\nimport { UserMediaService } from './webrtc/user-media.service';\r\nimport { WebRTCClientService } from './webrtc/webrtc-client.service';\r\nimport { WebSocketService } from './webrtc/websocket.service';\r\n\r\nexport default class AppComponent extends Component {\r\n\r\n\tget remotePeers() {\r\n\t\treturn (this.peers || []).filter(x => x !== this.uid);\r\n\t}\r\n\r\n\tonInit() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tnode.classList.remove('hidden');\r\n\t\t// console.log('AppComponent');\r\n\r\n\t\tthis.local = null;\r\n\t\tthis.uid = null;\r\n\t\tthis.peers = [];\r\n\t\tthis.remotes = [];\r\n\t\tthis.streams = [];\r\n\r\n\t\tSignalingService.in$.pipe(\r\n\t\t\ttap(message => {\r\n\t\t\t\t// console.log('AppComponent.SignalingService.in$', message);\r\n\t\t\t\tswitch (message.type) {\r\n\t\t\t\t\tcase 'socketConnected':\r\n\t\t\t\t\t\tthis.onSocketConnected();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'joined':\r\n\t\t\t\t\t\tthis.onJoined(message.peerId);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'leaved':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'peers':\r\n\t\t\t\t\t\tthis.onPeers(message.peers);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'peerJoined':\r\n\t\t\t\t\t\tif (message.peerId !== this.uid) {\r\n\t\t\t\t\t\t\tthis.onPeerJoined(message.peerId);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'peerLeaved':\r\n\t\t\t\t\t\tif (message.peerId !== this.uid) {\r\n\t\t\t\t\t\t\tthis.onPeerLeaved(message.peerId);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'peerInfo':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'peerInfos':\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'offer':\r\n\t\t\t\t\t\tthis.onOffer(message);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t).subscribe();\r\n\r\n\t\t// rewire messages to socket service\r\n\t\tSignalingService.out$.pipe(\r\n\t\t\tfilter(message => {\r\n\t\t\t\tswitch (message.type) {\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttap(message => WebSocketService.send(message)),\r\n\t\t).subscribe();\r\n\r\n\t\tWebRTCClientService.remotes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(remotes => {\r\n\t\t\t// console.log('AppComponent.remotes', remotes);\r\n\t\t\tthis.remotes = remotes;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t}\r\n\r\n\tonJoin(event) {\r\n\t\tif (this.uid) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tUserMediaService.getUserMedia().then(stream => {\r\n\t\t\tthis.local = stream;\r\n\t\t\tthis.pushChanges();\r\n\t\t\tWebSocketService.connect(null, (message) => SignalingService.in(message));\r\n\t\t});\r\n\t}\r\n\r\n\tonSocketConnected() {\r\n\t\tSignalingService.out({ type: 'join', uid: WebSocketService.uid, info: { firstName: 'Jhon', lastName: 'Appleseed' } });\r\n\t}\r\n\r\n\tonJoined(uid) {\r\n\t\tthis.uid = WebSocketService.uid = uid;\r\n\t\tthis.pushChanges();\r\n\t\tWebSocketService.send({ type: 'peers', uid: WebSocketService.uid });\r\n\t}\r\n\r\n\tonPeers(peers) {\r\n\t\tthis.peers = peers;\r\n\t\tWebRTCClientService.addPeers(this.local, this.uid, this.remotePeers);\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n\tonPeerJoined(peerId) {\r\n\t\tconst index = this.peers.indexOf(peerId);\r\n\t\tif (index === -1) {\r\n\t\t\tthis.peers.push(peerId);\r\n\t\t\tthis.pushChanges();\r\n\t\t}\r\n\t}\r\n\r\n\tonPeerLeaved(peerId) {\r\n\t\tconst index = this.peers.indexOf(peerId);\r\n\t\tif (index !== -1) {\r\n\t\t\tthis.peers.splice(index, 1);\r\n\t\t\tthis.pushChanges();\r\n\t\t}\r\n\t\tWebRTCClientService.removePeer(peerId);\r\n\t}\r\n\r\n\tonCall(peerId) {\r\n\t\treturn;\r\n\t\t/*\r\n\t\tconsole.log('AppComponent.onCall', peerId);\r\n\t\tconst client = this.client = WebRTCClient.call(this.local, this.uid, peerId);\r\n\t\tclient.streams$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(streams => {\r\n\t\t\tthis.streams = streams;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t\t*/\r\n\t}\r\n\r\n\tonOffer(message) {\r\n\t\t// console.log('AppComponent.onOffer', message);\r\n\t\tconst client = WebRTCClientService.addPeer(this.local, this.uid, message.uid);\r\n\t\tif (client != null) {\r\n\t\t\tclient.onMessageOffer(message);\r\n\t\t}\r\n\t\t/*\r\n\t\tif (this.client) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst client = this.client = WebRTCClient.answer(this.local, this.uid, message.uid);\r\n\t\tclient.onMessageOffer(message);\r\n\t\tclient.streams$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(streams => {\r\n\t\t\tthis.streams = streams;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t\t*/\r\n\t}\r\n\r\n}\r\n\r\nAppComponent.meta = {\r\n\tselector: '[app-component]',\r\n};\r\n","\r\nexport const environmentServed = {\r\n\tflags: {\r\n\t\tproduction: true,\r\n\t},\r\n\tlogo: null,\r\n\tbackground: {\r\n\t\timage: '/Client/docs/img/background.jpg',\r\n\t\tvideo: '/Client/docs/img/background.mp4',\r\n\t},\r\n\tcolors: {\r\n\t\tmenuBackground: '#000000',\r\n\t\tmenuForeground: '#ffffff',\r\n\t\tmenuOverBackground: '#0099ff',\r\n\t\tmenuOverForeground: '#ffffff',\r\n\t\tmenuBackBackground: '#0099ff',\r\n\t\tmenuBackForeground: '#000000',\r\n\t\tmenuBackOverBackground: '#0099ff',\r\n\t\tmenuBackOverForeground: '#ffffff',\r\n\t},\r\n\tassets: '/Client/docs/',\r\n\tworker: '/Client/docs/js/workers/image.service.worker.js',\r\n\tgithubDocs: 'https://raw.githubusercontent.com/actarian/terranova/main/docs/',\r\n\turl: {\r\n\t\tindex: '/',\r\n\t},\r\n\tlanguages: ['en'],\r\n\tdefaultLanguage: 'en',\r\n};\r\n","\r\nexport class Utils {\r\n\r\n\tstatic merge(target, source) {\r\n\t\tif (typeof source === 'object') {\r\n\t\t\tObject.keys(source).forEach(key => {\r\n\t\t\t\tconst value = source[key];\r\n\t\t\t\tif (typeof value === 'object' && !Array.isArray(value)) {\r\n\t\t\t\t\ttarget[key] = this.merge(target[key], value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttarget[key] = value;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn target;\r\n\t}\r\n\r\n}\r\n","import { environmentServed } from './environment.served';\r\nimport { environmentStatic } from './environment.static';\r\nimport { Utils } from './utils/utils';\r\n\r\nexport const NODE = (typeof module !== 'undefined' && module.exports);\r\nexport const PARAMS = NODE ? { get: () => { } } : new URLSearchParams(window.location.search);\r\nexport const DEBUG = false || (PARAMS.get('debug') != null);\r\nexport const BASE_HREF = NODE ? null : document.querySelector('base').getAttribute('href');\r\nexport const HEROKU = NODE ? false : (window && window.location.host.indexOf('herokuapp') !== -1);\r\nexport const STATIC = NODE ? false : (HEROKU || (window && (window.location.port === '41789' || window.location.port === '5000' || window.location.port === '6443' || window.location.host === 'actarian.github.io')));\r\nexport const DEVELOPMENT = NODE ? false : (window && ['localhost', '127.0.0.1', '0.0.0.0'].indexOf(window.location.host.split(':')[0]) !== -1);\r\nexport const PRODUCTION = !DEVELOPMENT;\r\nexport const ENV = {\r\n\tSTATIC,\r\n\tDEVELOPMENT,\r\n\tPRODUCTION\r\n};\r\n\r\nexport class Environment {\r\n\r\n\tget STATIC() {\r\n\t\treturn ENV.STATIC;\r\n\t}\r\n\tset STATIC(STATIC) {\r\n\t\tENV.STATIC = (STATIC === true || STATIC === 'true');\r\n\t\t// console.log('Environment.STATIC.set', ENV.STATIC);\r\n\t}\r\n\r\n\tget href() {\r\n\t\tif (HEROKU) {\r\n\t\t\treturn this.githubDocs;\r\n\t\t} else {\r\n\t\t\treturn BASE_HREF;\r\n\t\t}\r\n\t}\r\n\r\n\tgetAbsoluteUrl(path, params) {\r\n\t\tlet url = `${window.location.origin}${path}`;\r\n\t\t// let url = `${window.location.protocol}//${window.location.host}${path}`;\r\n\t\tObject.keys(params).forEach(key => {\r\n\t\t\turl = url.replace(`$${key}`, params[key]);\r\n\t\t});\r\n\t\treturn url;\r\n\t}\r\n\r\n\tgetPath(path) {\r\n\t\treturn this.isLocal(path) ? (this.href + path) : path;\r\n\t}\r\n\r\n\tisLocal(path) {\r\n\t\treturn path.indexOf('://') === -1;\r\n\t}\r\n\r\n\tconstructor(options) {\r\n\t\tif (options) {\r\n\t\t\tif (typeof options.url === 'object') {\r\n\t\t\t\tconst language = options.language || '';\r\n\t\t\t\tconst market = options.market || '';\r\n\t\t\t\tObject.keys(options.url).forEach(key => {\r\n\t\t\t\t\toptions.url[key] = language + market + options.url[key];\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tObject.assign(this, options);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst defaultOptions = {\r\n\tport: 5000,\r\n\tfontFamily: 'GT Walsheim, sans-serif',\r\n\tcolors: {\r\n\t\tmenuBackground: '#000000',\r\n\t\tmenuForeground: '#ffffff',\r\n\t\tmenuOverBackground: '#0099ff',\r\n\t\tmenuOverForeground: '#ffffff',\r\n\t\tmenuBackBackground: '#0099ff',\r\n\t\tmenuBackForeground: '#000000',\r\n\t\tmenuBackOverBackground: '#0099ff',\r\n\t\tmenuBackOverForeground: '#ffffff',\r\n\t},\r\n\teditor: {\r\n\t\tdisabledViewTypes: ['waiting-room', 'room-3d'],\r\n\t\tdisabledViewItemTypes: ['texture'],\r\n\t},\r\n\trenderOrder: {\r\n\t\tpanorama: 0,\r\n\t\tmodel: 10,\r\n\t\tplane: 20,\r\n\t\ttile: 30,\r\n\t\tbanner: 40,\r\n\t\tnav: 50,\r\n\t\tpanel: 60,\r\n\t\tmenu: 70,\r\n\t\tdebug: 80,\r\n\t\tpointer: 90,\r\n\t}\r\n};\r\n\r\nconst defaultAppOptions = {\r\n\tchannelName: 'BHere',\r\n\tflags: {\r\n\t\tproduction: false,\r\n\t\tuseProxy: false,\r\n\t\tuseToken: false,\r\n\t\tselfService: true,\r\n\t\tguidedTourRequest: true,\r\n\t\teditor: true,\r\n\t\tar: true,\r\n\t\tmenu: true,\r\n\t\tattendee: true,\r\n\t\tstreamer: true,\r\n\t\tviewer: true,\r\n\t\tsmartDevice: true,\r\n\t\tmaxQuality: false,\r\n\t\theroku: HEROKU,\r\n\t},\r\n};\r\n\r\nconst environmentOptions = window.STATIC ? environmentStatic : environmentServed;\r\n\r\nlet options = Object.assign(defaultOptions, defaultAppOptions, environmentOptions);\r\noptions = Utils.merge(options, window.bhere);\r\n\r\nexport const environment = new Environment(options);\r\n\r\nconsole.log('environment', environment);\r\n","\r\nexport const environmentStatic = {\r\n\tflags: {\r\n\t\tproduction: false,\r\n\t},\r\n\tlogo: null,\r\n\tbackground: {\r\n\t\timage: '/terranova/img/background.jpg',\r\n\t\tvideo: '/terranova/img/background.mp4',\r\n\t},\r\n\tcolors: {\r\n\t\tmenuBackground: '#000000',\r\n\t\tmenuForeground: '#ffffff',\r\n\t\tmenuOverBackground: '#0099ff',\r\n\t\tmenuOverForeground: '#ffffff',\r\n\t\tmenuBackBackground: '#0099ff',\r\n\t\tmenuBackForeground: '#000000',\r\n\t\tmenuBackOverBackground: '#0099ff',\r\n\t\tmenuBackOverForeground: '#ffffff',\r\n\t},\r\n\tassets: '/terranova/',\r\n\tworker: './js/workers/image.service.worker.js',\r\n\tgithubDocs: 'https://raw.githubusercontent.com/actarian/terranova/main/docs/',\r\n\turl: {\r\n\t\tindex: '/',\r\n\t},\r\n\tlanguages: ['en'],\r\n\tdefaultLanguage: 'en',\r\n};\r\n","import { Pipe } from \"rxcomp\";\r\nimport { environment } from \"../environment\";\r\n\r\nexport default class FlagPipe extends Pipe {\r\n\r\n\tstatic transform(key) {\r\n\t\tconst flags = environment.flags;\r\n\t\treturn flags[key] || false;\r\n\t}\r\n\r\n}\r\n\r\nFlagPipe.meta = {\r\n\tname: 'flag',\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\n\r\nexport default class WebRTCStreamComponent extends Component {\r\n\r\n\tonChanges() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst video = node.querySelector('video');\r\n\t\tif (video.srcObject !== this.stream) {\r\n\t\t\tvideo.srcObject = this.stream;\r\n\t\t\t// console.log('WebRTCStreamComponent', video, this.stream);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nWebRTCStreamComponent.meta = {\r\n\tselector: '[webrtc-stream]',\r\n\tinputs: ['stream'],\r\n\ttemplate: /* html */ `\r\n\t\t<div class=\"webrtc-stream\">\r\n\t\t\t<video playsinline autoplay muted></video>\r\n\t\t</div>\r\n\t`\r\n};\r\n","import { CoreModule, Module } from 'rxcomp';\r\nimport AppComponent from './app.component';\r\nimport FlagPipe from './flag/flag.pipe';\r\nimport WebRTCStreamComponent from './webrtc/webrtc-stream.component';\r\n\r\nexport class AppModule extends Module { }\r\n\r\nAppModule.meta = {\r\n\timports: [\r\n\t\tCoreModule,\r\n\t],\r\n\tdeclarations: [\r\n\t\tFlagPipe,\r\n\t\tWebRTCStreamComponent,\r\n\t],\r\n\tbootstrap: AppComponent,\r\n};\r\n","import { Browser } from 'rxcomp';\r\nimport { AppModule } from './app.module';\r\n\r\nBrowser.bootstrap(AppModule);\r\n"]}